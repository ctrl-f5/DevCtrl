<?php /** @var $this \Ctrl\View\PhpView */ ?>
<?php $project = $this->project     /** @var $project   \DevCtrl\Domain\Project */ ?>
<?php $types = $this->itemTypes;    /** @var $types     \DevCtrl\Domain\Item\Type\Type[] */ ?>
<?php echo $this->pageTitle('Project', $this->project->getName()); ?>

<?php $this->page = 'backlog'; ?>
<?php echo $this->render('dev-ctrl/project/partial/project-tabs.phtml'); ?>

<div class="btn-group">
    <a class="btn dropdown-toggle btn-primary" data-toggle="dropdown" href="#">
        New item
        <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
        <?php foreach ($types as $t): ?>
        <li><a href="<?php echo $this->url('item_create', array(
            'type' => $t->getId(),
            'project' => $project->getId()
        )); ?>"><?php echo $t->getName(); ?></a></li>
        <?php endforeach; ?>
    </ul>
</div>
<p></p>
<div class="">
    <table class="table table-striped">
        <tr>
            <th width="30">progress</th>
            <th>title</th>
            <th>date created</th>
            <th>state</th>
            <th>actions</th>
        </tr>
        <?php foreach ($backlog as $i): ?>
        <tr>
            <td rowspan="2">
                <button class="btn"><canvas class="ctrljs-3stage-gauge" guage-value="1<?php echo $i->getProgress(); ?>" width="50" height="50"></canvas></button>
            </td>
            <td><?php echo $i->getId(); ?></td>
            <td><?php echo $i->getTitle(); ?></td>
            <td><?php echo $this->formatDate($i->getDateCreated()); ?></td>
            <td><?php if ($i->getItemType()->hasStates()) echo $i->getState()->getLabel(); ?></td>
            <td><a class="btn btn-info" href="<?php echo $this->url('default/id', array(
                'controller' => 'item',
                'action' => 'detail',
                'id' => $i->getId()
            )); ?>">detail</a></td>
        </tr>
        <tr>
            <td colspan="5"><?php echo $i->getDescription(); ?></td>
        </tr>
        <?php endforeach; ?>
    </table>
</div>